---
title: "部分檢視"
author: ardalis
description: "使用 ASP.NET Core MVC 中的部分檢視"
keywords: "ASP.NET Core，部分檢視部分"
ms.author: riande
manager: wpickett
ms.date: 03/14/2017
ms.topic: article
ms.assetid: 4be1b12c-b74e-44ff-826b-99ce86e8d464
ms.technology: aspnet
ms.prod: asp.net-core
uid: mvc/views/partial
ms.openlocfilehash: 60f5255ca31accbffffec18053b29810977a5ff1
ms.sourcegitcommit: 732cd2684246e49e796836596643a8d37e20c46d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/01/2017
---
# <a name="partial-views"></a><span data-ttu-id="183b2-104">部分檢視</span><span class="sxs-lookup"><span data-stu-id="183b2-104">Partial Views</span></span>

<span data-ttu-id="183b2-105">由[Steve Smith](https://ardalis.com/)， [Maher JENDOUBI](https://twitter.com/maherjend)，和[Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="183b2-105">By [Steve Smith](https://ardalis.com/), [Maher JENDOUBI](https://twitter.com/maherjend), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="183b2-106">ASP.NET Core MVC 支援部分檢視，當您有想要不同的檢視之間共用的 web 網頁的可重複使用的組件時相當實用。</span><span class="sxs-lookup"><span data-stu-id="183b2-106">ASP.NET Core MVC supports partial views, which are useful when you have reusable parts of web pages you want to share between different views.</span></span>

<span data-ttu-id="183b2-107">[檢視或下載範例程式碼](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/views/partial/sample)([如何下載](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="183b2-107">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/views/partial/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-are-partial-views"></a><span data-ttu-id="183b2-108">部分檢視有哪些？</span><span class="sxs-lookup"><span data-stu-id="183b2-108">What are Partial Views?</span></span>

<span data-ttu-id="183b2-109">部分檢視是另一個檢視中呈現的檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-109">A partial view is a view that is rendered within another view.</span></span> <span data-ttu-id="183b2-110">所執行的部分檢視產生的 HTML 輸出轉譯成呼叫 （或父） 檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-110">The HTML output generated by executing the partial view is rendered into the calling (or parent) view.</span></span> <span data-ttu-id="183b2-111">部分檢視所使用的檢視，例如*.cshtml*檔案副檔名。</span><span class="sxs-lookup"><span data-stu-id="183b2-111">Like views, partial views use the *.cshtml* file extension.</span></span>

## <a name="when-should-i-use-partial-views"></a><span data-ttu-id="183b2-112">何時應該使用部分檢視？</span><span class="sxs-lookup"><span data-stu-id="183b2-112">When Should I Use Partial Views?</span></span>

<span data-ttu-id="183b2-113">部分檢視是較大檢視重大的有效方式。</span><span class="sxs-lookup"><span data-stu-id="183b2-113">Partial views are an effective way of breaking up large views into smaller components.</span></span> <span data-ttu-id="183b2-114">它們可以減少重複的檢視內容，並允許可重複使用的檢視項目。</span><span class="sxs-lookup"><span data-stu-id="183b2-114">They can reduce duplication of view content and allow view elements to be reused.</span></span> <span data-ttu-id="183b2-115">一般的版面配置項目應該指定在[_Layout.cshtml](layout.md)。</span><span class="sxs-lookup"><span data-stu-id="183b2-115">Common layout elements should be specified in [_Layout.cshtml](layout.md).</span></span> <span data-ttu-id="183b2-116">非版面配置可重複使用的內容可以封裝到部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-116">Non-layout reusable content can be encapsulated into partial views.</span></span>

<span data-ttu-id="183b2-117">如果您有幾個邏輯部分所組成的複雜頁面時，可能很有用，才能使用它自己的部分檢視為每個片段。</span><span class="sxs-lookup"><span data-stu-id="183b2-117">If you have a complex page made up of several logical pieces, it can be helpful to work with each piece as its own partial view.</span></span> <span data-ttu-id="183b2-118">每個頁面片段就可以在獨立於其餘的頁面上，檢視，因為它只包含整體頁面結構和呼叫來呈現部分檢視網頁本身的檢視會變得簡單許多。</span><span class="sxs-lookup"><span data-stu-id="183b2-118">Each piece of the page can be viewed in isolation from the rest of the page, and the view for the page itself becomes much simpler since it only contains the overall page structure and calls to render the partial views.</span></span>

<span data-ttu-id="183b2-119">提示： 請依照下列[不重複自行原則](http://deviq.com/don-t-repeat-yourself/)在檢視中。</span><span class="sxs-lookup"><span data-stu-id="183b2-119">Tip: Follow the [Don't Repeat Yourself Principle](http://deviq.com/don-t-repeat-yourself/) in your views.</span></span>

## <a name="declaring-partial-views"></a><span data-ttu-id="183b2-120">宣告的部分檢視</span><span class="sxs-lookup"><span data-stu-id="183b2-120">Declaring Partial Views</span></span>

<span data-ttu-id="183b2-121">部分檢視會建立任何其他檢視一樣： 您建立*.cshtml*檔案內*檢視*資料夾。</span><span class="sxs-lookup"><span data-stu-id="183b2-121">Partial views are created like any other view: you create a *.cshtml* file within the *Views* folder.</span></span> <span data-ttu-id="183b2-122">沒有任何部分檢視和一般檢視之間的語意差異-只會以不同的方式呈現。</span><span class="sxs-lookup"><span data-stu-id="183b2-122">There is no semantic difference between a partial view and a regular view - they are just rendered differently.</span></span> <span data-ttu-id="183b2-123">您可以檢視所傳回的控制站的直接`ViewResult`，和相同檢視可用來當做部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-123">You can have a view that is returned directly from a controller's `ViewResult`, and the same view can be used as a partial view.</span></span> <span data-ttu-id="183b2-124">在檢視和部分檢視轉譯的方式主要差異在於，部分檢視不會執行*_viewstart.vbhtml* (雖然檢視動作-深入了解*_viewstart.vbhtml*中[版面配置](layout.md)).</span><span class="sxs-lookup"><span data-stu-id="183b2-124">The main difference between how a view and a partial view are rendered is that partial views do not run *_ViewStart.cshtml* (while views do - learn more about *_ViewStart.cshtml* in [Layout](layout.md)).</span></span>

## <a name="referencing-a-partial-view"></a><span data-ttu-id="183b2-125">參考的部分檢視</span><span class="sxs-lookup"><span data-stu-id="183b2-125">Referencing a Partial View</span></span>

<span data-ttu-id="183b2-126">從在檢視頁面上，有數種您可以在將部分檢視轉譯的方式。</span><span class="sxs-lookup"><span data-stu-id="183b2-126">From within a view page, there are several ways in which you can render a partial view.</span></span> <span data-ttu-id="183b2-127">最簡單的是，若要使用`Html.Partial`，它會傳回`IHtmlString`前置詞與呼叫的方式，來參考和`@`:</span><span class="sxs-lookup"><span data-stu-id="183b2-127">The simplest is to use `Html.Partial`, which returns an `IHtmlString` and can be referenced by prefixing the call with `@`:</span></span>

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=9)]

<span data-ttu-id="183b2-128">`PartialAsync`方法有可用的部分 （雖然一般不提倡檢視中的程式碼），檢視包含的非同步程式碼：</span><span class="sxs-lookup"><span data-stu-id="183b2-128">The `PartialAsync` method is available for partial views containing asynchronous code (although code in views is generally discouraged):</span></span>

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=8)]

<span data-ttu-id="183b2-129">您可以呈現部分檢視與`RenderPartial`。</span><span class="sxs-lookup"><span data-stu-id="183b2-129">You can render a partial view with `RenderPartial`.</span></span> <span data-ttu-id="183b2-130">這個方法未傳回結果。傳送至回應直接轉譯的輸出資料流。</span><span class="sxs-lookup"><span data-stu-id="183b2-130">This method doesn't return a result; it streams the rendered output directly to the response.</span></span> <span data-ttu-id="183b2-131">因為它未傳回結果，必須呼叫 Razor 程式碼區塊內 (您也可以呼叫`RenderPartialAsync`如有必要):</span><span class="sxs-lookup"><span data-stu-id="183b2-131">Because it doesn't return a result, it must be called within a Razor code block (you can also call `RenderPartialAsync` if necessary):</span></span>

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=10-12)]

<span data-ttu-id="183b2-132">因為它會直接串流結果`RenderPartial`和`RenderPartialAsync`在某些情況下可能會更好。</span><span class="sxs-lookup"><span data-stu-id="183b2-132">Because it streams the result directly, `RenderPartial` and `RenderPartialAsync` may perform better in some scenarios.</span></span> <span data-ttu-id="183b2-133">不過，在大部分情況下，則建議您使用`Partial`和`PartialAsync`。</span><span class="sxs-lookup"><span data-stu-id="183b2-133">However, in most cases it's recommended you use `Partial` and `PartialAsync`.</span></span>

> [!NOTE]
> <span data-ttu-id="183b2-134">如果您的檢視，就需要執行程式碼，但建議的模式是使用[檢視元件](view-components.md)而不是部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-134">If your views need to execute code, the recommended pattern is to use a [view component](view-components.md) instead of a partial view.</span></span>

### <a name="partial-view-discovery"></a><span data-ttu-id="183b2-135">部分檢視探索</span><span class="sxs-lookup"><span data-stu-id="183b2-135">Partial View Discovery</span></span>

<span data-ttu-id="183b2-136">當參考的部分檢視，您可以參考其位置數種方式：</span><span class="sxs-lookup"><span data-stu-id="183b2-136">When referencing a partial view, you can refer to its location in several ways:</span></span>

```text
// Uses a view in current folder with this name
// If none is found, searches the Shared folder
@Html.Partial("ViewName")

// A view with this name must be in the same folder
@Html.Partial("ViewName.cshtml")

// Locate the view based on the application root
// Paths that start with "/" or "~/" refer to the application root
@Html.Partial("~/Views/Folder/ViewName.cshtml")
@Html.Partial("/Views/Folder/ViewName.cshtml")

// Locate the view using relative paths
@Html.Partial("../Account/LoginPartial.cshtml")
```

<span data-ttu-id="183b2-137">您可以在不同檢視資料夾具有相同名稱的不同部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-137">You can have different partial views with the same name in different view folders.</span></span> <span data-ttu-id="183b2-138">當參考檢視的名稱 （不含副檔名），每個資料夾中的檢視會使用部分檢視它們的相同資料夾中。</span><span class="sxs-lookup"><span data-stu-id="183b2-138">When referencing the views by name (without file extension), views in each folder will use the partial view in the same folder with them.</span></span> <span data-ttu-id="183b2-139">您也可以指定預設部分檢視，若要使用，放在*共用*資料夾。</span><span class="sxs-lookup"><span data-stu-id="183b2-139">You can also specify a default partial view to use, placing it in the *Shared* folder.</span></span> <span data-ttu-id="183b2-140">共用的部分檢視將供沒有自己的版本部分檢視的任何檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-140">The shared partial view will be used by any views that don't have their own version of the partial view.</span></span> <span data-ttu-id="183b2-141">您可以有預設的部分檢視 (在*共用*)，這會覆寫具有相同名稱做為父檢視的相同資料夾中的部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-141">You can have a default partial view (in *Shared*), which is overridden by a partial view with the same name in the same folder as the parent view.</span></span>

<span data-ttu-id="183b2-142">部分檢視可以是*鏈結*。</span><span class="sxs-lookup"><span data-stu-id="183b2-142">Partial views can be *chained*.</span></span> <span data-ttu-id="183b2-143">也就是說，部分檢視 （只要您未建立迴圈），可以呼叫另一個部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-143">That is, a partial view can call another partial view (as long as you don't create a loop).</span></span> <span data-ttu-id="183b2-144">在每一個檢視或部分檢視，相對路徑一律是相對於該檢視，而非從根目錄或父檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-144">Within each view or partial view, relative paths are always relative to that view, not the root or parent view.</span></span>

> [!NOTE]
> <span data-ttu-id="183b2-145">如果您宣告[Razor](razor.md) `section`在部分檢視中，它將看不到其父系，則會限制為部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-145">If you declare a [Razor](razor.md) `section` in a partial view, it will not be visible to its parent(s); it will be limited to the partial view.</span></span>

## <a name="accessing-data-from-partial-views"></a><span data-ttu-id="183b2-146">從部分檢視存取資料</span><span class="sxs-lookup"><span data-stu-id="183b2-146">Accessing Data From Partial Views</span></span>

<span data-ttu-id="183b2-147">部分檢視具現化時，它會取得一份父檢視`ViewData`字典。</span><span class="sxs-lookup"><span data-stu-id="183b2-147">When a partial view is instantiated, it gets a copy of the parent view's `ViewData` dictionary.</span></span> <span data-ttu-id="183b2-148">父檢視不會保存對部分檢視內的資料更新。</span><span class="sxs-lookup"><span data-stu-id="183b2-148">Updates made to the data within the partial view are not persisted to the parent view.</span></span> <span data-ttu-id="183b2-149">`ViewData`變更的部分檢視時，遺失部分檢視會傳回。</span><span class="sxs-lookup"><span data-stu-id="183b2-149">`ViewData` changed in a partial view is lost when the partial view returns.</span></span>

<span data-ttu-id="183b2-150">您可以將傳遞的執行個體`ViewDataDictionary`部分檢視：</span><span class="sxs-lookup"><span data-stu-id="183b2-150">You can pass an instance of `ViewDataDictionary` to the partial view:</span></span>

```csharp
@Html.Partial("PartialName", customViewData)
   ```

<span data-ttu-id="183b2-151">您也可以將模型傳遞至部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-151">You can also pass a model into a partial view.</span></span> <span data-ttu-id="183b2-152">這可以是頁面檢視模型，或某些部分或自訂的物件。</span><span class="sxs-lookup"><span data-stu-id="183b2-152">This can be the page's view model, or some portion of it, or a custom object.</span></span> <span data-ttu-id="183b2-153">您可以將模型傳遞至`Partial`，`PartialAsync`， `RenderPartial`，或`RenderPartialAsync`:</span><span class="sxs-lookup"><span data-stu-id="183b2-153">You can pass a model to `Partial`,`PartialAsync`, `RenderPartial`, or `RenderPartialAsync`:</span></span>

```csharp
@Html.Partial("PartialName", viewModel)
   ```

<span data-ttu-id="183b2-154">您可以將傳遞的執行個體`ViewDataDictionary`和部分檢視的檢視模型：</span><span class="sxs-lookup"><span data-stu-id="183b2-154">You can pass an instance of `ViewDataDictionary` and a view model to a partial view:</span></span>

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml?range=15-16)]

<span data-ttu-id="183b2-155">下面顯示的標記*Views/Articles/Read.cshtml*其中包含兩個部分檢視的檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-155">The markup below shows the *Views/Articles/Read.cshtml* view which contains two partial views.</span></span> <span data-ttu-id="183b2-156">在模型中的第二個部分檢視通過和`ViewData`部分檢視。</span><span class="sxs-lookup"><span data-stu-id="183b2-156">The second partial view passes in a model and `ViewData` to the partial view.</span></span> <span data-ttu-id="183b2-157">您可以在新的傳遞`ViewData`同時保留現有的字典`ViewData`如果您使用的建構函式多載`ViewDataDictionary`反白顯示如下：</span><span class="sxs-lookup"><span data-stu-id="183b2-157">You can pass new `ViewData` dictionary while retaining the existing `ViewData` if you use the constructor overload of the `ViewDataDictionary` highlighted below:</span></span>

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml)]

<span data-ttu-id="183b2-158">*檢視/共用/AuthorPartial*:</span><span class="sxs-lookup"><span data-stu-id="183b2-158">*Views/Shared/AuthorPartial*:</span></span>

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Shared/AuthorPartial.cshtml)]

<span data-ttu-id="183b2-159">*ArticleSection*部分：</span><span class="sxs-lookup"><span data-stu-id="183b2-159">The *ArticleSection* partial:</span></span>

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Articles/ArticleSection.cshtml)]

<span data-ttu-id="183b2-160">在執行階段，會轉譯 partials 呈現父檢視中，而其本身內共用*_Layout.cshtml*</span><span class="sxs-lookup"><span data-stu-id="183b2-160">At runtime, the partials are rendered into the parent view, which itself is rendered within the shared *_Layout.cshtml*</span></span>

![部分檢視輸出](partial/_static/output.png)
